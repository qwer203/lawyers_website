document.addEventListener('DOMContentLoaded', () => {

    // --- ЧАСТЬ 1: АККОРДЕОН (ТЕРМИНЫ) ---
    // Работает на любой странице, где есть классы .term
    const terms = document.querySelectorAll('.term');
    
    // Проверяем, есть ли термины вообще
    if (terms.length > 0) {
        terms.forEach((term, index) => {
            const btn = term.querySelector('.term__btn');
            const panel = term.querySelector('.term__panel');
            if (!btn || !panel) return;

            // Если id у панели нет — создадим уникальный
            if (!panel.id) panel.id = `term-panel-${index}`;
            
            // Назначаем ARIA-атрибуты для доступности (опционально)
            btn.setAttribute('aria-controls', panel.id);

            btn.addEventListener('click', () => {
                const isOpen = term.classList.toggle('is-open');
                btn.setAttribute('aria-expanded', String(isOpen));
                panel.hidden = !isOpen;
            });
        });
    }


    // --- ЧАСТЬ 2: ТЕСТ ---
    // Весь код ниже выполнится ТОЛЬКО если на странице найден блок с id="quiz"
    const quizContainer = document.getElementById('quiz');
    const resultContainer = document.getElementById('result'); 
    
    if (quizContainer) {
        
        const questions = [
          {
            text: "Интеллектуальная собственность – это",
            options: ["результат интеллектуальной деятельности субъектов;", "результат интеллектуальной и, прежде всего, творческой деятельности субъектов", "охраняемый результат интеллектуальной, прежде всего, творческой деятельности субъектов;", "охраняемый результат деятельности субъектов."],
            correct: 2
          },
          {
            text: "Интеллектуальная собственность – это",
            options: ["совокупность результатов интеллектуальной деятельности", "совокупность результатов интеллектуальной деятельности и средств индивидуализации;", "совокупность результатов интеллектуальной деятельности и приравненных к этим результатам средств индивидуализации, которым предоставляется правовая охрана", "совокупность исключительных прав на результаты интеллектуальной деятельности субъектов."],
            correct: 2
          },
          {
            text: "Признаки результатов интеллектуальной собственности",
            options: ["создается за счет воображения человека;", "творческий характер;", "охрана нормами морали и права;", "принадлежит субъекту, обладающему сознанием"],
            correct: 1
          },
          {
            text: "Исключительные права на результат интеллектуальной деятельности являются",
            options: ["обязательственными", "личными неимущественными;", "имущественными;", "вещными."],
            correct: 2
          },
          {
            text: "Исключительное право на результат интеллектуальной деятельности может принадлежать",
            options: ["только одному лицу", "только нескольким лицам совместно", "нескольким лицам с определением доли каждого из них", "одному или нескольким лицам совместно"],
            correct: 3
          },
          {
            text: "Обладатель исключительного права на результат интеллектуальной деятельности вправе распорядиться этим правом:",
            options: ["с согласия лица, оказавшего ему материальное содействие", "с согласия лица, высказавшего идею произведения;", "самостоятельно;", "с согласия лица, к которому на определенный срок перешло его исключительное право на результат интеллектуальной деятельности."],
            correct: 2
          },
          {
            text: "Исключительные права на результаты интеллектуальной деятельности представляют ценность",
            options: ["моральную;", "имущественную", "личную", "неимущественную."],
            correct: 1
          },
          {
            text: "Срок действия исключительного права на результат интеллектуальной деятельности устанавливается",
            options: ["Конституцией Российской Федерации;", "Гражданским кодексом Российской Федерации;", "Законом РФ «Об авторских и смежных правах»;", "Женевской конвенцией об авторском праве."],
            correct: 1
          },
          {
            text: "Исключительные права на результаты интеллектуальной деятельности являются предметом регулирования",
            options: ["федерального законодательства", "законодательства субъектов РФ", "муниципальных правовых актов", "всех названных выше уровней"],
            correct: 0
          },
          {
            text: "Не является источником права интеллектуальной собственности в России",
            options: ["Конвенция об охране интересов производителей фонограмм от незаконного воспроизводства их фонограмм 1971 г.;", "Всемирная (Женевская) конвенция об авторском праве 1952;", "Директива ЕС «Эфирное вещание через спутники кабельная ретрансляция»;", "Евразийская патентная конвенция"],
            correct: 2
          },
          {
            text: "Объектами авторского права являются",
            options: ["федеральные законы", "судебные решения", "литературные произведения;", "постановления Правительства РФ"],
            correct: 2
          },
          {
            text: "Авторские права не распространяются на",
            options: ["необнародованные произведения, существующие в письменном виде", "произведения, обнародованные в устной форме, если они доведены до неопределенного круга лиц", "неопубликованные произведения, существующие в форме изображения", "открытия"],
            correct: 3
          },
          {
            text: "Не являются объектами авторских прав произведения",
            options: ["народного творчества", "драматические", "музыкальные", "сценарные"],
            correct: 0
          },
          {
            text: "Произведение считается самостоятельным, если",
            options: ["его содержание оригинально", "его содержание заимствовано (полностью или частично)", "его форма и содержание заимствовано", "его форма оригинальна"],
            correct: 0
          },
          {
            text: "Произведение как объект авторского права должно быть",
            options: ["результатом интеллектуальной деятельности", "содержать новые идеи", "выражено на материальном носителе, принадлежащему автору на праве собственности", "иметь объективную форму выражения, обеспечивающую его воспроизведение"],
            correct: 3
          },
          {
            text: "Разработки по созданию новой техники относятся к следующему институту права интеллектуальной собственности",
            options: ["патентного права", "авторского права", "правовой охраны средств индивидуализации участников хозяйственного оборота и производимой ими продукции", "правовой охраны нетрадиционных объектов ИС"],
            correct: 0
          },
          {
            text: "Соавторами произведения признаются лица",
            options: ["оказавшие автору техническую помощь в создании произведения", "организовавшие работу по созданию произведения", "создавшие произведение совместным трудом", "оказавшие автору материальную помощь"],
            correct: 2
          },
          {
            text: "Программа для ЭВМ – это",
            options: ["материальный объект, представленный в виде данных и команд, предназначенных для функционирования ЭВМ", "нематериальный объект, используемый в ЭВМ или ином компьютерном устройстве для получения определенного результата", "представленная в объективной форме совокупность данных и команд, предназначенных для функционирования ЭВМ и других компьютерных устройств", "система криптографического и математического решения устройства, предназначенного для функционирования ЭВМ и других компьютерных средств"],
            correct: 2
          },
          {
            text: "На программы для ЭВМ и базы данных распространяются нормы",
            options: ["авторского права", "патентного права", "чч. 1–3 ГК РФ", "ФЗ РФ «О связи»."],
            correct: 0
          },
          {
            text: "База данных – это",
            options: ["совокупность данных, команд, правил, предназначенных для систематизации определенных материалов", "совокупность материалов, предназначенных для выполнения определенной задачи с помощью ЭВМ", "представленная в объективной форме совокупность самостоятельных материалов, систематизированных в целях поиска и обработки с помощью ЭВМ", "совокупность программ и материалов в памяти ЭВМ"],
            correct: 2
          },
          {
            text: "Обладатели авторских прав в случае нарушения своих прав, вправе требовать",
            options: ["признания права; восстановления положения, существующего до нарушения права; пресечения действий, нарушающих их права или создающих угрозу их нарушения", "возмещения убытков; компенсации морального вреда; публикации решения суда о допущенном нарушении; выплаты компенсации", "все вышеперечисленное"],
            correct: 2
          },
          {
            text: "По общему правилу исключительное право на исполнение действует",
            options: ["в течение всей жизни исполнителя и 50 лет после смерти", "в течение всей жизни исполнителя, но не менее 30 лет, считая с 1 января года, следующего за годом, в котором осуществлены исполнение, либо запись исполнения", "в течение всей жизни исполнителя, но не менее 50 лет, считая с 1 января года, следующего за годом, в котором осуществлены исполнение, либо запись исполнения."],
            correct: 2
          },
          {
            text: "Авторский договор – это…",
            options: ["гражданско-правовой, двусторонний (многосторонний), консенсуальный, безвозмездный", "публичный, односторонний, реальный, возмездный", "гражданско-правовой, двусторонний (многосторонний), консенсуальный, возмездный"],
            correct: 2
          },
          {
            text: "Институт средства индивидуализации юридических лиц, товаров, работ, услуги предприятий включает",
            options: ["фирменные наименования, коммерческие обозначения", "товарные знаки, знаки обслуживания, наименование мест происхождения товаров", "все вышеперечисленное"],
            correct: 2
          },
          {
            text: "К личным неимущественным правам автора относятся",
            options: ["Опубликование произведения", "Воспроизведение произведения", "Перевод произведения", "Переработку произведения "],
            correct: 0
          }
        ];

        // Отрисовка вопросов
        questions.forEach((q, index) => {
            let html = `<h3>${index + 1}. ${q.text}</h3>`;
            q.options.forEach((opt, optIndex) => {
                html += `
                    <div>
                        <input type="radio" name="q${index}" value="${optIndex}" id="q${index}_opt${optIndex}">
                        <label for="q${index}_opt${optIndex}">${opt}</label>
                    </div>
                `;
            });
            html += "<hr>";
            quizContainer.innerHTML += html;
        });

        
        const checkButton = document.getElementById('checkBtn');

        if (checkButton) {
            checkButton.addEventListener('click', () => {
                let score = 0;

                questions.forEach((q, index) => {
                    const selected = document.querySelector(`input[name="q${index}"]:checked`);
                    if (selected && parseInt(selected.value) === q.correct) {
                        score++;
                    }
                });
                
                // Очищаем вопросы
                quizContainer.innerHTML = ""; 
                
                // Скрываем кнопку
                checkButton.style.display = 'none';
                
                // Выводим результат
                // Если есть спец. контейнер для результата — выводим туда, иначе — в блок теста
                const targetContainer = resultContainer || quizContainer;
                
                targetContainer.innerHTML = `
                    <h2 style="text-align: center; margin-top: 50px;">
                        Ваш результат: ${score} из ${questions.length}
                    </h2>`;
            });
        }
    }
});
